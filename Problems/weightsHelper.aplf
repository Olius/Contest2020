 weightsHelper←{

     template←0⍨¨¨A J L R←⍵∘(⍸⍤∊)¨a j l r←⎕A'┴' '┌' '┐'
     I←(∊template)←⍳N←⍴∊template
     Ia Ij Il Ir←template

     Rlr Raj←(Il,Ir)(Ia,1↓Ij)⌷¨∘⊂¨⍨Slr Saj←⍋∘(⌽¨)¨(L,R)(A,1↓J)

     vertical←(Rlr∘.=I)-Raj∘.=I
     horizontalSum←(Il∘.=I)+(Ir∘.=I)-Ij∘.=I
     Cl Cr←L R-⍥(⊢/¨¨)⊂J
     horizontalBalance←(Cl×[⎕IO]Il∘.=I)+Cr×[⎕IO]Ir∘.=I

     (∊template)←(N↑1)⌹(N↑1)⍪vertical⍪horizontalSum⍪horizontalBalance
     template

 }
